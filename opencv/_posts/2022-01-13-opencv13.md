---
layout: post
title: opencv(c++) 13. 모폴로지(Morphology) 기법(opening, closing)
subtitle: 모폴로지 기법 (열림, 닫힘)
gh-repo: harley-hwan/harley-hwan.github.io
gh-badge: [star, fork, follow]
tags: [opencv, c++, vs, visual studio, morphology, opening, closing]
comments: true
---

# opencv c++ 모폴로지(Morphology) 기법 - opening (열림), closing (닫힘)

- 최초 작성일: 2022년 1월 13일(목)

## 목차

[TOC]

<br/>

## 목표

앞서 했던 모폴로지 기법 중 침식, 팽창 연산에 이어 열림, 닫힘 연산에 대해 알아보자.

열림 연산은 닫혀있는 것을 열어주는 것, 닫힘 연산은 열려있는 것을 닫아주는 것인데

다르게 얘기하면, 열림 연산은 "연결되어 있는 걸 끊어주는 것", 닫힘 연산은 "끊어져있는 걸 연결해주는 것" 이라고 할 수 있다.

<br/>

### 열림 연산 (opening)

아래의 이미지가 열림 연산 (opening) 과정을 보여주는 것이다.

열림 연산은 침식연산 (erode) 후에 팽창연산 (dilate) 하는 것이다.

침식연산을 하면 연결되어 있던 부분이 끊어지고, 물체의 전체적인 면적도 같이 줄어들기 때문에 다시 팽창연산을 통해 원래의 크기로 되돌려주는 것이다.

그러면 전체적인 크기는 그대로지만, 연결되어 있던 부분은 끊어져 있는 결과가 나온다.

![image](https://user-images.githubusercontent.com/68185569/149267474-91ea76b5-7b1f-4b64-9b23-0793e17479b2.png)

<br/>

### 닫힘 연산 (closing)

아래의 이미지가 닫힘 연산 (closing) 과정을 보여주는 것이다.

닫힘 연산은 반대로 팽창연산 (dilate) 후에 침식연산 (erode) 하는 것이다.

팽창연산을 하면 뚝뚝 끊겨있는 부분을 연결해주며, 물체의 전체적인 면적도 같이 커지기 때문에 다시 침식연산을 통해 원래의 크기로 되돌려주는 것이다.

그러면 전체적인 크기는 그대로지만, 툭툭 끊겨있던 부분이 연결되는 결과가 나온다.

![image](https://user-images.githubusercontent.com/68185569/149267486-1f32e302-09fd-4334-b636-d84c0bed13de.png)

<br/>

---

## 실습

침식(enode) 연산 후 팽창(dilate) 연산을 해보면서 열림(opening) 연산의 정의에 맞게 결과가 나오는지 확인한다.

팽창(dilate) 연산 후 침식(enode) 연산을 해보면서 닫힘(closing) 연산의 정의에 맞게 결과가 나오는지 확인한다.

---

## 소스 코드

```c++
#include <stdio.h>
#include <opencv2/opencv.hpp>

using namespace std;
using namespace cv;

int main() {
	Mat img = imread("doctor.png", 0);	// grayscale image

	Mat img_dilate;
	Mat img_erode;
	
	Mat img_threshold;

	threshold(img, img_threshold, 180, 255, THRESH_BINARY);

	dilate(img_threshold, img_dilate, Mat::ones(Size(3, 3), CV_8UC1), Point(-1, -1));
	erode(img_threshold, img_erode, Mat::ones(Size(3, 3), CV_8UC1), Point(-1, -1));

	imshow("original", img_threshold);

	imshow("img_dilate", img_dilate);
	imshow("img_erode", img_erode);
	
	waitKey(0);

	return 0;
}
```

---

<br/>

## 결과

열림 연산(opening) = 침식 연산(enode) + 팽창 연산(dilate)

닫힘 연산(closing) = 팽창 연산(dilate) + 침식 연산(enode)

<br/>

![image](https://user-images.githubusercontent.com/68185569/149274205-80b66d2c-4f63-409b-a0b6-f613457168c2.png)

<br/>

![image](https://user-images.githubusercontent.com/68185569/149274524-5a47ec1f-ccbc-479a-bb9e-be9fb669d1e0.png)


